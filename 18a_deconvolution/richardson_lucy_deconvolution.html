
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Richardson-Lucy-Deconvolution on OpenCL-compatible GPUs &#8212; Bio-image Analysis Notebooks</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Spatial transforms" href="../19_spatial_transforms/readme.html" />
    <link rel="prev" title="Determining the point-spread-function from a bead image" href="extract_psf.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Bio-image Analysis Notebooks</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Bio-image Analysis Notebooks
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../01_introduction/trailer.html">
   Trailer: Bio-image Analysis with Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01_introduction/readme.html">
   Setting up your computer
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02_python_basics/readme.html">
   Python basics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_python_basics/01_our_first_juptyer_notebook.html">
     Python code in Jupyter notebooks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_python_basics/02_Math_in_python.html">
     Basic math in python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_python_basics/03_Dont_try_this_at_home.html">
     Pitfalls when working with Jupyter notebooks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_python_basics/04_Basic_types.html">
     Basic types in python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_python_basics/05_lists_tuples.html">
     Lists and tuples
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_python_basics/05a_cropping_lists.html">
     Cropping lists
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_python_basics/05b_sorting_lists.html">
     Sorting lists
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_python_basics/06_Dictionaries_and_tables.html">
     Dictionaries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_python_basics/07_Conditions.html">
     Conditions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_python_basics/08_loops.html">
     Loops
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_python_basics/09_custom_functions.html">
     Functions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../03_advanced_python/readme.html">
   Advanced python programming
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_advanced_python/custom_libraries.html">
     Custom libraries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_advanced_python/functional_parameters.html">
     Functional parameters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_advanced_python/napari_workflows.html">
     Workflows in napari
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_advanced_python/parallelization.html">
     Parallelization
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../12_image_analysis_basics/readme.html">
   Image analysis basics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../12_image_analysis_basics/01_Introduction_to_image_processing.html">
     Introduction to image processing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../12_image_analysis_basics/02_Working_with_images.html">
     Working with images
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../12_image_analysis_basics/04_multi_channel_image_data.html">
     Multi-channel image data
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../15_gpu_acceleration/readme.html">
   GPU accelerated image processing
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../15_gpu_acceleration/clesperanto.html">
     clEsperanto
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../15_gpu_acceleration/why_GPU_acceleration.html">
     Why GPU-acceleration makes sense
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../15_gpu_acceleration/cupy.html">
     GPU-accelerated image processing using CUPY and CUCIM
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../15_gpu_acceleration/memory_management.html">
     Tracing memory consumption
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../15_gpu_acceleration/further_reading.html">
     Further reading
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../16_3d_image_visualization/readme.html">
   Image visualization in 3D
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../16_3d_image_visualization/10_nd_image_data.html">
     Multidimensional image stacks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../16_3d_image_visualization/inspecting_3d_images.html">
     Inspecting 3D image data with pyclesperanto
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../16_3d_image_visualization/05_napari.html">
     Interactive image visualization with napari
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../18_image_filtering/readme.html">
   Image filtering
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../18_image_filtering/01_Filtering.html">
     Filtering images
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../18_image_filtering/convolution.html">
     Convolution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../18_image_filtering/02_noise_removal.html">
     Noise removal filters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../18_image_filtering/03_background_removal.html">
     Background removal filters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../18_image_filtering/edge_detection_and_enhancement.html">
     Edge detection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../18_image_filtering/simpleitk.html">
     Processing images using SimpleITK
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="readme.html">
   Image deconvolution
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="introduction_deconvolution.html">
     An introduction to image deconvolution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="extract_psf.html">
     Determining the point-spread-function from a bead image
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Richardson-Lucy-Deconvolution on OpenCL-compatible GPUs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../19_spatial_transforms/readme.html">
   Spatial transforms
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../19_spatial_transforms/coordinate_systems.html">
     Coordinate systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../19_spatial_transforms/cropping.html">
     Slicing and cropping
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../19_spatial_transforms/affine_transforms_scikit_image.html">
     Affine transforms using scikit-image
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../19_spatial_transforms/affine_transforms_scipy.html">
     Affine transforms using Scipy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../19_spatial_transforms/affine_transforms_cupy.html">
     Affine transforms using cupy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../19_spatial_transforms/affine_transforms_clesperanto.html">
     Affine transforms using clesperanto
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../20_image_segmentation/readme.html">
   Image segmentation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../20_image_segmentation/06_Introduction_to_image_segmentation.html">
     Image segmentation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20_image_segmentation/07_Thresholding.html">
     Thresholding
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20_image_segmentation/08_binary_mask_refinement.html">
     Binary mask refinement
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20_image_segmentation/split_touching_objects.html">
     Split touching objects
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20_image_segmentation/09_connected_component_labeling.html">
     Label images
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20_image_segmentation/10_touching_objects_labeling.html">
     Touching objects labeling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20_image_segmentation/11_voronoi_otsu_labeling.html">
     Voronoi-Otsu-labeling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20_image_segmentation/14_remove_labels_on_image_edges.html">
     Remove labels on image edges
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20_image_segmentation/15_sequential_labeling.html">
     Sequential object (re-)labeling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20_image_segmentation/segmentation_2d_membranes.html">
     Image Segmentation from membrane images
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20_image_segmentation/nsbatwm.html">
     Segment nuclei and cells (blobs and things with membranes)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20_image_segmentation/Segmentation_3D.html">
     3D Image Segmentation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../20a_pixel_classification/readme.html">
   Machine learning for image segmentation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../20a_pixel_classification/scikit_learn_random_forest_pixel_classifier.html">
     Pixel classification using Scikit-learn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20a_pixel_classification/apoc_object_segmenter.html">
     Object segmentation on OpenCL-compatible GPUs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20a_pixel_classification/apoc_pixel_classifier_continue_training.html">
     Pixel classification on OpenCL-compatible GPUs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20a_pixel_classification/apoc_probability_mapper.html">
     Probability maps
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20a_pixel_classification/apoc_train_on_folders.html">
     Training pixel classifiers from folders of images
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20a_pixel_classification/feature_stacks.html">
     Generating feature stacks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20a_pixel_classification/selecting_features.html">
     Selecting features
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../22_feature_extraction/readme.html">
   Feature extraction
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../22_feature_extraction/quantitative_measurements.html">
     Quantitative image analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../22_feature_extraction/count_blobs.html">
     Counting bright objects in images
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../22_feature_extraction/statistics_with_pyclesperanto.html">
     Basic statistics with pyclesperanto
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../22_feature_extraction/statistics_with_simpleitk.html">
     Statistics using SimpleITK
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../22_feature_extraction/comparison_of_measurements_from_different_libraries.html">
     Comparison of measurements from different libraries
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../25_neighborhood_relationships_between_cells/readme.html">
   Neighborhood analysis in tissues
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../25_neighborhood_relationships_between_cells/01_neighborhood_definitions.html">
     Neighborhood definitions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../25_neighborhood_relationships_between_cells/05_count_touching_neighbors.html">
     Count touching neighbors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../25_neighborhood_relationships_between_cells/06_mesh_with_distances.html">
     Draw distance-meshes between neighbors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../25_neighborhood_relationships_between_cells/distance_to_other_labels.html">
     Measure the distance to cells in another label image
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../25_neighborhood_relationships_between_cells/other_proximal_labels_count.html">
     Count proximal labels in an other label image
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../25_neighborhood_relationships_between_cells/neighbor_meshes_in_3d.html">
     Neighbor meshes in three dimensions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../25_neighborhood_relationships_between_cells/label_neighbor_filters.html">
     Label neighbor filters
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../27_cell_classification/readme.html">
   Cell classification
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../27_cell_classification/apoc_object_classifier.html">
     Object classification on OpenCL-compatible GPUs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../27_cell_classification/forest_statistics.html">
     Random forest decision making statistics
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../28_colocalization/readme.html">
   Colocalization
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../28_colocalization/counting_nuclei_multichannel.html">
     Counting nuclei according to expression in multiple channels
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../28_colocalization/differentiate_nuclei_intensity.html">
     Differentiating nuclei according to signal intensity
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../31_graphical_user_interfaces/readme.html">
   Graphical user interfaces
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../31_graphical_user_interfaces/napari_magicgui.html">
     Interactive parameter tuning with napari and magicgui
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../31_graphical_user_interfaces/napari_dask.html">
     Tribolium embryo morphometry over time in Napari
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../31_graphical_user_interfaces/napari_crop.html">
     Interactive cropping with napari
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../32_tiled_image_processing/readme.html">
   Tiled image processing
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../32_tiled_image_processing/tiled_nuclei_counting_quick.html">
     Tiled image processing, a quick run-through
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../32_tiled_image_processing/tiling_images_naive_approach.html">
     Tiling images - the naive approach
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../32_tiled_image_processing/tiling_images_with_overlap.html">
     Tiling images with overlap
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../32_tiled_image_processing/tiled_connected_component_labeling.html">
     Connected component labeling in tiles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../32_tiled_image_processing/tiled_object_measurements.html">
     Measurements in objects in tiled images
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../32_tiled_image_processing/tiled_image_file_formats_zarr.html">
     Tiled image file formats: zarr
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../32_tiled_image_processing/tiled_area_mapping.html">
     Map area of objects in tiles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../32_tiled_image_processing/tiled_nuclei_counting.html">
     Counting nuclei in tiles
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../33_batch_processing/readme.html">
   Batch processing
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
  <label for="toctree-checkbox-17">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../33_batch_processing/12_process_folders.html">
     How process files in a folder
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../40_tabular_data_wrangling/readme.html">
   Tabular data wrangling
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
  <label for="toctree-checkbox-18">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../40_tabular_data_wrangling/introduction_dataframes.html">
     Introduction to working with DataFrames
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../40_tabular_data_wrangling/explore_dataset.html">
     Exploring tabular data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../40_tabular_data_wrangling/descriptive_statistics.html">
     Basic descriptive statistcs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../40_tabular_data_wrangling/handling_NaNs.html">
     Handling NaN values
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../40_tabular_data_wrangling/pivot_tables.html">
     Pivot tables
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../51_plotting/readme.html">
   Plotting
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
  <label for="toctree-checkbox-19">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../51_plotting/plotting_seaborn.html">
     Plotting using seaborn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../51_plotting/plotting_matplotlib.html">
     Plotting with Matplotlib
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../51_plotting/bland_altman_analysis.html">
     Bland-Altman plots
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../60_data_visualization/readme.html">
   Data visualization
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
  <label for="toctree-checkbox-20">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../60_data_visualization/overlay_text_on_image.html">
     Overlay texts on images
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../60_data_visualization/parametric_maps.html">
     Parametric maps
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../60_data_visualization/quantitative_neighbor_maps.html">
     Quantitative maps from neighbor statistics
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../imprint.html">
   Imprint
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/18a_deconvolution/richardson_lucy_deconvolution.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/haesleinhuepf/BioImageAnalysisNotebooks"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/haesleinhuepf/BioImageAnalysisNotebooks/issues/new?title=Issue%20on%20page%20%2F18a_deconvolution/richardson_lucy_deconvolution.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/haesleinhuepf/BioImageAnalysisNotebooks/main?urlpath=tree/docs/18a_deconvolution/richardson_lucy_deconvolution.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Richardson-Lucy-Deconvolution on OpenCL-compatible GPUs</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="richardson-lucy-deconvolution-on-opencl-compatible-gpus">
<h1>Richardson-Lucy-Deconvolution on OpenCL-compatible GPUs<a class="headerlink" href="#richardson-lucy-deconvolution-on-opencl-compatible-gpus" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Richardson%E2%80%93Lucy_deconvolution">Richardson-Lucy-Deconvolution</a> is a common and yet basic algorithm for image deconvolution in microscopy. In this notebook we will use a GPU-accelerated version of it that is implemented in the napari-plugin <a class="reference external" href="https://github.com/rosalindfranklininstitute/RedLionfish">RedLionFish</a>. Hence, you can use the same algorithm from the graphical user interface in napari.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">skimage.io</span> <span class="kn">import</span> <span class="n">imread</span>
<span class="kn">from</span> <span class="nn">pyclesperanto_prototype</span> <span class="kn">import</span> <span class="n">imshow</span>
<span class="kn">import</span> <span class="nn">RedLionfishDeconv</span> <span class="k">as</span> <span class="nn">rl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<p>We will load an image showing fluorescent intensity along lines. This 3D image was taken with a confocal microscope.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">image</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="s1">&#39;../../data/DeconvolutionSampleVerticalGrid1AU-crop.tif&#39;</span><span class="p">)</span>
<span class="n">image</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(21, 150, 150)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/richardson_lucy_deconvolution_4_0.png" src="../_images/richardson_lucy_deconvolution_4_0.png" />
</div>
</div>
<p>The following PSF image was extracted from images taken with the same microscope using the procedure <a class="reference internal" href="extract_psf.html#deconvolution-extract-psf"><span class="std std-ref">explained before</span></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psf</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="s1">&#39;../../data/psf.tif&#39;</span><span class="p">)</span>

<span class="n">imshow</span><span class="p">(</span><span class="n">psf</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/richardson_lucy_deconvolution_6_0.png" src="../_images/richardson_lucy_deconvolution_6_0.png" />
</div>
</div>
<p>We can now deconvolve the image using RedLionFish’s Richardson-Lucy-Deconvolution algorithm. We should specify that the algorith shall be executed on the <code class="docutils literal notranslate"><span class="pre">gpu</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iterations</span> <span class="o">=</span> <span class="mi">50</span>

<span class="n">deconvolved</span> <span class="o">=</span> <span class="n">rl</span><span class="o">.</span><span class="n">doRLDeconvolutionFromNpArrays</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> 
                                               <span class="n">psf</span><span class="p">,</span> 
                                               <span class="n">niter</span><span class="o">=</span><span class="n">iterations</span><span class="p">,</span> 
                                               <span class="n">method</span><span class="o">=</span><span class="s1">&#39;gpu&#39;</span><span class="p">,</span> 
                                               <span class="n">resAsUint8</span><span class="o">=</span><span class="kc">False</span> <span class="p">)</span>
<span class="n">imshow</span><span class="p">(</span><span class="n">deconvolved</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ERROR:root:Failed to setup Reikna with OpenCL.
ERROR:root:No module named &#39;reikna&#39;
</pre></div>
</div>
<img alt="../_images/richardson_lucy_deconvolution_8_1.png" src="../_images/richardson_lucy_deconvolution_8_1.png" />
</div>
</div>
<p>To visualize more precisely how the original image and the deconvolved version differ, we can plot the intensity along a line from the left to the right. We retrieve these numbers from a maximum intensity projection along Z.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">max_intensity_image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">max_intensity_image</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(150, 150)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">max_intensity_deconvolved</span> <span class="o">=</span> <span class="n">deconvolved</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">max_intensity_deconvolved</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(150, 150)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">max_intensity_image</span><span class="p">[</span><span class="mi">80</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">max_intensity_deconvolved</span><span class="p">[</span><span class="mi">80</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/richardson_lucy_deconvolution_12_0.png" src="../_images/richardson_lucy_deconvolution_12_0.png" />
</div>
</div>
<p>As you can see, the intensity range has change through deconvolution. This depends on the algorithm and implementation. Whenever applying deconvolution, consider checking if the total intensity in the original image and the deconvolved image are within the same range:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">image</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">image</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1, 8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">deconvolved</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">deconvolved</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.0, 28.122286)
</pre></div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./18a_deconvolution"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="extract_psf.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Determining the point-spread-function from a bead image</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../19_spatial_transforms/readme.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Spatial transforms</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Robert Haase, Miguel Fernandes, Marcelo Leomil Zoccoler & add-your-name-here-by-sending-a-pull-request-containing-a-notebook<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>